<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SportElemz√©s ‚Äì friss cikkek</title>
  <link rel="stylesheet" href="assets/style.css" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%2300a6ff'/%3E%3Cpath d='M18 34l10 8 18-20' stroke='%23fff' stroke-width='6' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E" />
</head>
<body>

<header class="header-hero">
  <nav class="hero-nav">
    <a class="brand" href="/"><span>üèüÔ∏è</span> <span>SportElemz√©s</span></a>
    <div class="links">
      <a href="/">Elemz√©sek</a>
      <a href="/stats.html">Statisztika</a>
    </div>
  </nav>

  <div class="hero-inner">
    <h1>SportElemz√©s</h1>
    <p>Elemz√©sek, adatok, eredm√©nyek ‚Äì naponta friss√≠tve</p>
  </div>
</header>

<main>
  <section>
    <h2>Friss elemz√©sek</h2>
    <div id="feed" class="post-list"></div>
  </section>
</main>

<footer>
  ¬© <span id="y"></span> SportElemz√©s ‚Ä¢ GitHub Pages
</footer>

<script>
  // √©v a l√°bl√©cben
  document.getElementById('y').textContent = new Date().getFullYear();

  // egyszer≈± util a d√°tum form√°z√°sra
  const fmtDate = iso => {
    if (!iso) return '';
    const d = new Date(iso);
    if (isNaN(d)) return iso;
    const p = n => String(n).padStart(2, '0');
    return `${d.getFullYear()}.${p(d.getMonth()+1)}.${p(d.getDate())}.`;
  };

  // Cikkek bet√∂lt√©se v√©detten
  async function loadPosts() {
    const box = document.getElementById('feed');
    box.innerHTML = '<div class="muted">Cikkek bet√∂lt√©se‚Ä¶</div>';

    try {
      // cache bust: ha tegnap l√©trehoztad a JSON-t, a CDN m√©g cache-elheti
      const res = await fetch('posts/index.json?ts=' + Date.now(), { cache: 'no-store' });

      if (!res.ok) {
        box.innerHTML = '<div class="muted">M√©g nincs k√∂zz√©tett cikk (vagy a posts/index.json nem tal√°lhat√≥).</div>';
        return;
      }

      let list = [];
      try {
        list = await res.json();
      } catch (e) {
        box.innerHTML = '<div class="muted">Hib√°s JSON a posts/index.json f√°jlban.</div>';
        return;
      }

      if (!Array.isArray(list) || list.length === 0) {
        box.innerHTML = '<div class="muted">M√©g nincs k√∂zz√©tett cikk.</div>';
        return;
      }

      // D√°tum szerint cs√∂kken≈ë
      list.sort((a,b) => new Date(b.date||0) - new Date(a.date||0));

      const html = list.map(post => {
        const title   = post.title || 'C√≠m n√©lk√ºl';
        const slug    = post.slug  || '#';
        const date    = fmtDate(post.date);
        const league  = post.league || '';
        const excerpt = post.excerpt || '';

        return `
          <article class="card">
            <h3><a href="posts/${slug}.html">${title}</a></h3>
            <div class="muted">${date}${league ? ' ‚Ä¢ ' + league : ''}</div>
            <p class="summary">${excerpt}</p>
            <p><a href="posts/${slug}.html">Tov√°bb ‚Üí</a></p>
          </article>
        `;
      }).join('');

      box.innerHTML = html;

    } catch (err) {
      console.error(err);
      document.getElementById('feed').innerHTML =
        '<div class="muted">Nem siker√ºlt bet√∂lteni a cikkeket.</div>';
    }
  }

  loadPosts();
</script>
</body>
</html>
